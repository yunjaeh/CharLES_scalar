#
VERBOSE

# for c=200, p=28,571, gamma=1.4, rho=1, c = sqrt(gamma*p/rho)
DEFINE this_p 28571
DEFINE this_T 300
DEFINE this_rho 1
DEFINE this_interval_image 25
DEFINE this_interval_stats 50
DEFINE this_interval_result 15000
DEFINE this_interval_check 20
DEFINE this_interval_probe 1000
DEFINE this_size 20

RHO_REF $(this_rho)
P_REF $(this_p)
T_REF $(this_T)
MU_REF 3.333333e-3
GAMMA 1.4

RESTART ./box.mles
INIT_RUP $(this_rho) 1 0 0 $(this_p)

EOS=IDEAL_GAS_LSP

NSTEPS=100
CHECK_INTERVAL=$(this_interval_check)
TIMESTEP = CFL 1

SGS_MODEL VREMAN

#=== boundary conditions ====
main.x0 = CBC_RUP $(this_rho) 1 0.0 0.0 $(this_p)
main.x1 = NSCBC_OUTLET_P $(this_p) 0.2 1
main.y0 = WALL_ADIABATIC
main.y1 = WALL_ADIABATIC
main.z0 = WALL_ADIABATIC
main.z1 = WALL_ADIABATIC
cyl.x0  = WALL_ADIABATIC
cyl.x1  = WALL_ADIABATIC
cyl.cyl = WALL_ADIABATIC
#=============================

#=============================
# LSP 
#=============================
LSP.TIME_INT 2WAY_COUPLED
LSP.MATERIAL SOLID USER NAME=DUST1
DUST1.RHO    766
DUST1.CP     800
DUST1.K      1.4
DUST1.TMELT  1610

LSP.BC main.x1 OUTLET

LSP.INJECTOR inlet_g GEOM ZONE main.x0 VMAG 1 TYPE MDOT 5e-3 DIST GAUSSIAN COUNT_DIST 0 2e-3 1e-3 2e-4 TP $(this_T)

#LSP.INJECTOR inlet_mass_1 GEOM ZONE main.x0 VMAG 1 TYPE MDOT 1e-6 DIST RR MASS_DIST 0 200e-6 63e-6 1 TP $(this_T)
#LSP.INJECTOR inlet_count_1 GEOM ZONE main.x0 VMAG 1 TYPE MDOT 1e-6 DIST RR COUNT_DIST 0 200e-6 63e-6 1 TP $(this_T)

#LSP.INJECTOR inlet_mass_2 GEOM ZONE main.x0 VMAG 1 TYPE MDOT 1e-3 DIST RR MASS_DIST 0 2e-3 1e-3 2 TP $(this_T)
#LSP.INJECTOR inlet_count_2 GEOM ZONE main.x0 VMAG 1 TYPE MDOT 1e-3 DIST RR COUNT_DIST 0 2e-3 1e-3 2 TP $(this_T)

#LSP.INJECTOR inlet_count GEOM ZONE main.x0 VMAG 1 TYPE COUNT 1000 DIST RR COUNT_DIST 0 200e-6 63e-6 1 TP $(this_T)

#LSP.SHOW_HISTOGRAM FILE=./hist_mass_1/dp_hist INTERVAL=1000 NBINS=60 V_MASS
#LSP.SHOW_HISTOGRAM FILE=./hist_count_1/dp_hist INTERVAL=1000 NBINS=60 V_COUNT

#LSP.SHOW_HISTOGRAM FILE=./hist_mass_2/dp_hist INTERVAL=1000 NBINS=60 V_MASS
#LSP.SHOW_HISTOGRAM FILE=./hist_count_2/dp_hist INTERVAL=1000 NBINS=60 V_COUNT

LSP.SHOW_HISTOGRAM FILE=./dump/hist_g/dp_hist INTERVAL=$(this_interval_stats) NBINS=60 V_COUNT

#LSP.SHOW_HISTOGRAM V_COUNT V_MASS NBINS=60

LSP.STATS NAME=./dump/stats_g/inlet INTERVAL = $(this_interval_stats) GEOM DISK X -0.9999 0 0 N 1 0 0 R0 0 R1 2 NR 20 THETA0 -180 THETA1 180 NTHETA 40 PDF NBINS 100 DRANGE 0 2e-3
#LSP.STATS NAME=./stats_45deg/inlet INTERVAL =1000  GEOM RECTANGLE X -0.9999 0 0 N 1 0 0 T 0 -1 -1 SIDE1 3 SIDE2 3 NBINS1 60 NBINS2 60 PDF NBINS 100 DRANGE 0 2e-3

WRITE_IMAGE NAME=./dump/images/lsp INTERVAL=$(this_interval_image) TARGET 0.005554479081183672 0.05037340149283409 0.05757897347211838 CAMERA 1.1189696788787842 -0.9995656609535217 0.8687164187431335 UP -0.3302488625049591 0.3323100507259369 0.8834623694419861 SIZE 1336 790 WIDTH 5.858278751373291 HIDE_SUBZONES 5,1,3,2 GEOM PLANE 0 0.8800004720687866 0 0 1 0 VAR mag(u) VAR_ON_PARTICLE lsp PARTICLE_MAGNIFICATION $(this_size)
